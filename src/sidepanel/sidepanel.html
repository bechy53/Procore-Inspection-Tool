<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procore Inspection Filler</title>
    <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Procore Inspection Tool</h1>
            <p class="subtitle">Review/Fill Inspections</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="single">Single Inspection</button>
            <button class="tab-button" data-tab="bulk">Bulk Inspector</button>
        </div>

        <div id="singleTab" class="tab-content active">
        <div class="controls">
            <button id="extractBtn" class="btn btn-primary" title="Extract all inspection items from the current Procore page">
                Extract Items
            </button>
            <button id="cancelExtractBtn" class="btn btn-danger" style="display: none;" title="Cancel the extraction process">
                Cancel
            </button>
            <button id="exportBtn" class="btn btn-secondary" disabled title="Export extracted items to a CSV file for editing">
                Export CSV
            </button>
        </div>

        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Extracting items...</div>
        </div>

        <div class="metadata-container" id="metadataContainer" style="display: none;">
            <div class="metadata-header">Inspection Details</div>
            <div class="metadata-grid">
                <div class="metadata-item">
                    <span class="metadata-label">Name:</span>
                    <span class="metadata-value" id="metaName">-</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Location:</span>
                    <span class="metadata-value" id="metaLocation">-</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Number:</span>
                    <span class="metadata-value" id="metaNumber">-</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Type:</span>
                    <span class="metadata-value" id="metaType">-</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Status:</span>
                    <span class="metadata-value" id="metaStatus">-</span>
                </div>
                <div class="metadata-item">
                    <span class="metadata-label">Date:</span>
                    <span class="metadata-value" id="metaDate">-</span>
                </div>
            </div>
        </div>

        <div class="import-section">
            <label for="csvFileInput" class="file-label" title="Select a CSV file with your responses">
                Import CSV to Fill
            </label>
            <input type="file" id="csvFileInput" accept=".csv" class="file-input" title="Choose a CSV file containing inspection responses">
            <button id="fillBtn" class="btn btn-success" disabled title="Automatically fill the inspection with responses from the imported CSV">
                Fill Inspection
            </button>
        </div>

        <div class="stats-bar" id="statsBar" style="display: none;">
            <div class="stat-item">
                <span class="stat-label">Total Items:</span>
                <span class="stat-value" id="totalItems">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Filled:</span>
                <span class="stat-value" id="filledItems">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Empty:</span>
                <span class="stat-value" id="emptyItems">0</span>
            </div>
        </div>

        <div class="report-section" id="reportSection" style="display: none;">
            <div class="report-header">
                <h3>Response Report</h3>
            </div>
            <div class="report-stats">
                <div class="report-stat-item" data-filter="Yes">
                    <span class="report-stat-label">Yes:</span>
                    <span class="report-stat-value" id="yesCount">0</span>
                </div>
                <div class="report-stat-item" data-filter="No">
                    <span class="report-stat-label">No:</span>
                    <span class="report-stat-value" id="noCount">0</span>
                </div>
                <div class="report-stat-item" data-filter="N/A">
                    <span class="report-stat-label">N/A:</span>
                    <span class="report-stat-value" id="naCount">0</span>
                </div>
                <div class="report-stat-item" data-filter="Blank">
                    <span class="report-stat-label">Blank:</span>
                    <span class="report-stat-value" id="blankCount">0</span>
                </div>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all" title="Show all inspection items">All</button>
                <button class="filter-btn" data-filter="Yes" title="Show only items marked as Yes">Yes</button>
                <button class="filter-btn" data-filter="No" title="Show only items marked as No">No</button>
                <button class="filter-btn" data-filter="N/A" title="Show only items marked as N/A">N/A</button>
                <button class="filter-btn" data-filter="Blank" title="Show only items with no response">Blank</button>
            </div>
        </div>

        <div class="status" id="status">
            <p>Navigate to a Procore inspection and click "Extract Items" to begin.</p>
        </div>

        <div class="navigation-hint" id="navigationHint" style="display: none;">
            <p>Click any item below to navigate to it on the page</p>
        </div>

        <div class="items-container" id="itemsContainer">
            <!-- Inspection items will be listed here -->
        </div>
        </div>

        <div id="bulkTab" class="tab-content">
            <div class="bulk-controls">
                <button id="scanTabsBtn" class="btn btn-primary">
                    Scan Open Tabs
                </button>
                <button id="extractAllBtn" class="btn btn-success" disabled>
                    Extract All Inspections
                </button>
                <button id="cancelBulkBtn" class="btn btn-danger" style="display: none;">
                    Cancel
                </button>
                <button id="exportBulkBtn" class="btn btn-secondary" disabled>
                    Export Summary CSV
                </button>
                <button id="detailedReportBtn" class="btn btn-info" disabled>
                    Open Detailed Report
                </button>
            </div>

            <div class="bulk-progress-container" id="bulkProgressContainer" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="bulkProgressFill"></div>
                </div>
                <div class="progress-text" id="bulkProgressText">Processing...</div>
                <div class="progress-details" id="bulkProgressDetails"></div>
            </div>

            <div class="tabs-section" id="tabsSection" style="display: none;">
                <div class="section-header">
                    <h3>Found Inspection Tabs</h3>
                    <div class="tab-actions">
                        <button id="selectAllBtn" class="btn-link">Select All</button>
                        <button id="deselectAllBtn" class="btn-link">Deselect All</button>
                    </div>
                </div>
                <div id="tabsList" class="tabs-list">
                    <!-- Inspection tabs will be listed here -->
                </div>
            </div>

            <div class="summary-section" id="summarySection" style="display: none;">
                <div class="section-header">
                    <h3>Summary Report</h3>
                    <div class="summary-stats">
                        <div class="summary-stat">
                            <span class="stat-label">Total Inspections:</span>
                            <span class="stat-value" id="totalInspections">0</span>
                        </div>
                        <div class="summary-stat">
                            <span class="stat-label">Total Items:</span>
                            <span class="stat-value" id="totalAllItems">0</span>
                        </div>
                        <div class="summary-stat">
                            <span class="stat-label">Incomplete Items:</span>
                            <span class="stat-value stat-warning" id="totalIncomplete">0</span>
                        </div>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-buttons">
                        <button class="bulk-filter-btn active" data-filter="all">All</button>
                        <button class="bulk-filter-btn" data-filter="incomplete">Incomplete Only</button>
                        <button class="bulk-filter-btn" data-filter="complete">Complete Only</button>
                    </div>
                </div>

                <div id="inspectionsList" class="inspections-list">
                    <!-- Inspections will be listed here -->
                </div>
            </div>

            <div class="bulk-status" id="bulkStatus">
                <p>Click "Scan Open Tabs" to find all open Procore inspection pages.</p>
            </div>
        </div>

        <footer class="footer">
            <p>Developed by <strong>BECHY</strong> | Message on Teams with any questions or concerns</p>
        </footer>
    </div>

    <script src="sidepanel.js"></script>
</body>
</html>
